<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamVid - URL-Based Video Platform</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 20px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .add-video-form {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        input, textarea, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            border: none;
        }
        input, textarea {
            background: #2d2d2d;
            color: white;
        }
        button {
            background: #ff3d00;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        .video-card {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: hidden;
        }
        .video-player {
            width: 100%;
            height: 200px;
            background: black;
        }
        .video-info {
            padding: 15px;
        }
        .video-actions {
            display: flex;
            gap: 10px;
        }
        .video-actions button {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>StreamVid</h1>
        <button id="showFormBtn">Add Video by URL</button>
    </div>

    <div class="add-video-form" id="videoForm" style="display: none;">
        <h2>Add New Video</h2>
        <input type="text" id="videoTitle" placeholder="Video Title">
        <textarea id="videoDescription" placeholder="Description"></textarea>
        <input type="url" id="videoUrl" placeholder="Video URL (MP4, WebM, YouTube, etc.)">
        <input type="text" id="thumbnailUrl" placeholder="Thumbnail Image URL (optional)">
        <button id="addVideoBtn">Add Video</button>
    </div>

    <div class="video-grid" id="videoContainer">
        <!-- Videos will be added here -->
    </div>

    <script>
        // Store videos in localStorage
        let videos = JSON.parse(localStorage.getItem('videos')) || [];
        
        // DOM elements
        const showFormBtn = document.getElementById('showFormBtn');
        const videoForm = document.getElementById('videoForm');
        const addVideoBtn = document.getElementById('addVideoBtn');
        const videoContainer = document.getElementById('videoContainer');
        
        // Toggle form visibility
        showFormBtn.addEventListener('click', () => {
            videoForm.style.display = videoForm.style.display === 'none' ? 'block' : 'none';
        });
        
        // Add new video
        addVideoBtn.addEventListener('click', () => {
            const title = document.getElementById('videoTitle').value;
            const description = document.getElementById('videoDescription').value;
            const url = document.getElementById('videoUrl').value;
            const thumbnail = document.getElementById('thumbnailUrl').value || getDefaultThumbnail();
            
            if (!title || !url) {
                alert('Please provide at least a title and video URL');
                return;
            }
            
            const newVideo = {
                id: Date.now(),
                title,
                description,
                url,
                thumbnail,
                createdAt: new Date().toISOString()
            };
            
            videos.push(newVideo);
            saveVideos();
            renderVideos();
            
            // Reset form
            document.getElementById('videoTitle').value = '';
            document.getElementById('videoDescription').value = '';
            document.getElementById('videoUrl').value = '';
            document.getElementById('thumbnailUrl').value = '';
            videoForm.style.display = 'none';
        });
        
        // Save videos to localStorage
        function saveVideos() {
            localStorage.setItem('videos', JSON.stringify(videos));
        }
        
        // Render all videos
        function renderVideos() {
            videoContainer.innerHTML = '';
            
            videos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.innerHTML = `
                    <div class="video-player">
                        ${getVideoEmbedCode(video.url)}
                    </div>
                    <div class="video-info">
                        <h3>${video.title}</h3>
                        <p>${video.description}</p>
                        <div class="video-actions">
                            <button onclick="deleteVideo(${video.id})">Delete</button>
                        </div>
                    </div>
                `;
                videoContainer.appendChild(videoCard);
            });
        }
        
        // Generate embed code based on URL
        function getVideoEmbedCode(url) {
            // YouTube
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                const videoId = getYouTubeId(url);
                return `<iframe width="100%" height="100%" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>`;
            }
            
            // Vimeo
            if (url.includes('vimeo.com')) {
                const videoId = url.split('/').pop();
                return `<iframe width="100%" height="100%" src="https://player.vimeo.com/video/${videoId}" frameborder="0" allowfullscreen></iframe>`;
            }
            
            // Direct video file (MP4, WebM, etc.)
            return `
                <video width="100%" height="100%" controls poster="${videos.find(v => v.url === url)?.thumbnail || ''}">
                    <source src="${url}" type="${getVideoType(url)}">
                    Your browser does not support the video tag.
                </video>
            `;
        }
        
        // Extract YouTube ID from URL
        function getYouTubeId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }
        
        // Get video type from URL
        function getVideoType(url) {
            const extension = url.split('.').pop().split('?')[0];
            switch(extension) {
                case 'mp4': return 'video/mp4';
                case 'webm': return 'video/webm';
                case 'ogg': return 'video/ogg';
                default: return 'video/mp4';
            }
        }
        
        // Generate default thumbnail
        function getDefaultThumbnail() {
            return `https://via.placeholder.com/300x200/333/fff?text=No+Thumbnail`;
        }
        
        // Delete video
        function deleteVideo(id) {
            if (confirm('Are you sure you want to delete this video?')) {
                videos = videos.filter(video => video.id !== id);
                saveVideos();
                renderVideos();
            }
        }
        
        // Initial render
        renderVideos();
    </script>
</body>
</html>
